/* eslint-disable max-len */
import { config as dotenvConfig } from "dotenv";
import { resolve } from "path";
dotenvConfig({ path: resolve(__dirname, "../.env") });
import { WebSocket } from "ws";
import { ApiKeyCreds, ClobClient, Chain } from '@polymarket/clob-client';
import { ethers } from "ethers";

// eslint-disable-next-line max-len
const YES_TOKEN_ID =
    "34903150535579516944408642969393358898233907149423176755384736522963571947712";
// eslint-disable-next-line max-len
const NO_TOKEN_ID = "101663644132291628948941640236167350755556186103463576352391468661100238054595";
// eslint-disable-next-line max-len
const CONDITION_ID = "0x9deb0baac40648821f96f01339229a422e2f5c877de55dc4dbf981f95a1e709c";

interface subscriptionMessage {
    // only necessary for 'user' subscriptions
    auth?: { apiKey: string; secret: string; passphrase: string };
    type: string;
    markets: string[];
    assets_ids: string[];
}

async function generateApiCreds() {
    const key = process.env.POLYMARKET_PK;

    if (!key) {
        throw new Error("Private key (PK) is not defined in the environment variables.");
    }

    // Initialize the ClobClient with host and private key
    const restUrl: string = process.env.REST_URL!;
    const provider = new ethers.providers.JsonRpcProvider(process.env.RPC_URL || "https://polygon-rpc.com");
    const signer = new ethers.Wallet(`${process.env.POLYMARKET_PK}`, provider);
    const client = new ClobClient(restUrl, Chain.POLYGON, signer);


    const apiKey = await client.createOrDeriveApiKey();
    return apiKey;
}


/**
 *
 * @param type user | market
 */
async function main(type: "user" | "market" | "live-activity", creds: ApiKeyCreds | undefined) {
    const endpoint = `${process.env.WS_URL }/${type}`
    console.log(endpoint);
    const ws = new WebSocket(endpoint);

    let subscriptionMessage: subscriptionMessage = {} as subscriptionMessage;

    if (type !== "live-activity") {
        subscriptionMessage = {
            auth:
                type == "user" && creds
                    ? {
                          apiKey: creds.key,
                          secret: creds.secret,
                          passphrase: creds.passphrase,
                      }
                    : undefined,
            type,
            markets: [] as string[],
            assets_ids: [] as string[],
        };

        if (type == "user") {
            subscriptionMessage["markets"] = [CONDITION_ID];
        } else {
            //subscriptionMessage["assets_ids"] = [NO_TOKEN_ID, YES_TOKEN_ID];
            subscriptionMessage["assets_ids"] = [
"12587249270383995519477770676201713795766642272341462128076799685545985130168",
"23770576457483711315936652032937148549377466393544348229511195272919274089900",
"86256560528246104379421646911043380684452888130520633460869784910528193402345",
"16382923508581042474077925685084820950414060659613152890914732523276209832052",
"3940595179000449122799345552497659976843205281482462258387176279781078659085",
"14192511794797510978242206980010542603900698661696851906597486011803985177183",
"29334725947055424048993973596994895116626671835962758466257256625351322808097",
"101728531789696783784838474205465230834191555012906099252901200429883320157411",
"36073042341659378268721811665194156825460961626780903408351586800733788624134",
"30531100159145370986879300047864642365732067817909665644034177188714713736425",
"89500653753274037611441866121074758060747057996767960478029129417886232626220",
"38427016912972822162072587916008419247039204496770988217364124598802327485611",
"40859327722772349212593673594857036918145536381740586828356453026323434506150",
"19281205197192940091883401474936888400370288656076942113518528172723970516657",
"11703037439695411634616729994583589795903278022776270197995954717319293112739",
"69388262531869965019059804213041949911018345987072748847367125493478372382780",
"32343950510351954477853342659631367903035637010279135383987298023699250807236",
"55370953862594130820388042856329820015992904099783087517338088950747717234085",
"29572888421711325398148817726715418131012721051448136800730034423005662178213",
"61422768797868676541286236953572754367639421910509689187536791812673223923456",
"87596471947779523062190852955785361809058400144455017139483573019538878752511",
"78488080493789878859846482391224822393915508678850650654336402259597663413976",
"110471165666943569146025730055358036561082541050310755947806266487099053413703",
"42732666566615324810487840547538773808217520832406624513917058955766826446525",
"20631260345186725316139595407306880915553068212829560319351759831564342076751",
"24159466617602153414482542099022023724683734409323680392913052074372466425018",
"73984204827307430462843155871248232336315583279348227743643764900752885142305",
"14614740820566496317847747566423043186782293085139896419885881293762006037439",
"112823648597812956968498698090949195339090469075961672652274125797609717947199",
"47724394294184035954412533018922785680775867258823376225791691237531459862548",
"97286278395277014251007464274536996774529790873890404946719430710088037424879",
"3507221957811704618356724278167226885300365663785453470915072675145328511402",
"85406382872358703461808056541128660726011284003498933500048076318021321081815",
"96521701582234380942529172023879724698727252273697075024843937341575823832159",
"54972249031451859860942148420037929199354536126015193799056875387288916980974",
"36922414533659787048637712422052437335774902119687322308235254712775256324605",
"49598908099144558296984018857039933424851670174805686434044157698286043897574",
"85252310819229005282722656202989974444722174392015184916318779664760317574161",
"73660549457004956203195365682873047076903594127053353013948123287520288753037",
"15432319682735433796620905065338550948488500286913937174213426504883569597262",
"9041820862469329288078944749172822004366525157141266735625121564211458109075",
"15929992021995032628521328240885983068329127832170548159308802968973253511636",
"39537289546108274520759875668374426118294664612561301930981194379911692280635",
"78317903974323379675394062555632917265981370309835394174074722587097428072747",
"49034131550914416459163378265175218381841637937757695749406417166756981487102",
"4615715437242154483237883721441109312179317533162922565971786245057616076569",
"48612259411484635104454095772765768790836452182954842167457443020318409374669",
"112535449408906659047641747801823836938978948119356866901872803467147606314250",
"22792184069910558164234981434629054212327774238446611755572293950551298273652",
"35443282115278538443426526474638055414573060111077851574835663646061083982365",
"81848549935014978265939340798865321775462997415173781667099196971586801440587",
"8047888207159195196876752201773990576479217755176746313317782160287661264705",
"62531955624871651404050678415957641765981417247721500092286939948746476333014",
"20688438141600598310003049123660348187739283991439004911962527789187906977446",
"83916715093110635249691415303343165325494968198347040107361188301373728613469",
"83805341523907369024165174255167130940171529545010250637366561131170522585963",
"65096468337725122042108120110452367015827148226350246293978804540378700665763",
"21519697678964503302703973523290842146563976764554036152878146278461039200531",
"45991570651385977530523461196601742411607674027411433129222764854824516412226",
"92048721060229147314723551648707780426347138643750464267715433929234272643320",
"35124853842344717239339223513693957628011036696278461744823766261533865320898",
"94771809525474715800137720598668568778366593369135291504436209263614410505805",
"55806073059929539507843743041061846430365658768141157696205923101348706040668",
"48233971843545572235221681733026661186464110011323160003057995083168926335579",
"55576555914674906367384631138517067315546619008172143465949485697652373386109",
"70297767606044086439087969282656743579728211600664924412940623863898391593734",
"115309292577187773329123172189174871473752027257909943952811336782437693103018",
"46045949786494064864077937487188312822123090897597633852924831409171560824387",
"108134666644560575656869947532574609817829166531409192197401501331157689137883",
"80426932685692328243337473277487596459582852620640476209302802658278420136805",
"107477320037204243570148013289011892009389094317686082401506538012723414591529",
"78485083706864638253997960276637623785197553614266161869249701701597310480583",
"78756260161519358877217856685450477176456680655366023873600384534059550959529",
"98803683093371953932130911322180511471983688076195569291724818231849942905722",
"66134271844985459882668099882981924236975911432584903673678511824706722061261",
"8731417565601807295409402958205985538666048542434838816424103339283478982905",
"4683043131886093962214362318195809532525214179403595715193417628776767861455",
"29576606270298687309285193643063262360874703081424323290632419252085773143120",
"54334545726291691648642606657023832836655743608843450373040710280440112492277",
"93714912657240535908463758795008778064609158449393718705911619235274518117096",
"29883972901143955366786972164632179770205640902327382137111402943545095649586",
"62077796838156006150565591589222303636414661325682022163463084503399105397437",
"66298625459338212278893581088581991735961241850925992618849198385310827750736",
"113583852350081879769893341625966878252747784328504709274821453164899315697059",
"47662106248253065146901145034798114647761488510024280199369312862910512336886",
"44036416296375056849229076358597388336379175814244166450549903550607272462709",
"72947775317959543249632019443366223375618212921001319789211409016752023718738",
"20768468691430183607829171595442197445656199731857841847270212472749912125076",
"63812082322391520217888873114148085398841946754944759491055404988827687272719",
"44721245114231243316837020083282193291471361212373828390343468486002963794827",
"18688161466061214589173775472886625636282416766725357374011304952961482615338",
"60347420591278594690980316150877249564862873599961975279705450436972585099572",
"24592843305935531685580539712341632094479269345142328165374226580236180246380",
"11210778441070524308672552636378307523307566841697169395988625343368104535935",
"7282240974654800303328577762157796988229054792029789559538121611027503919109",
"4039323209168556884503531306717836843072332486199546835894242702181296524640",
"62930805207284149406906303563275342443611580250087168358050545194105354013507",
"25224541934898903488190234854198906016296275479795581937636250097685341761811",
"6491341145325554154697913603368917025769332405959980689683496086625406969236",
"1845779567886130524932357282559766318031771276042663517366104308405305689889",
"61846025197316761334352798093846410296286999817909095206754589218243616904809",
"74898772595223496802457877633411908336763923074879106906008974716164306358110",
"52681818259069535840908915946879955207381314427531974009355493973419214367635",
"64989669906944717529114165724550114105523477412065526479657944294821075328098",
"113846818716712213856974569035969202100270899231869225637323940876532188092491",
"71254935325666931750247896984753679022632727965428526304760274979349565473049",
"86762731994903611804470205597845229434048810562834145407382591724818292333408",
"14213701749135024099255345120491590459262438172836682404916653044518348569005",
"40866268661465347648895181130758646442658363902138890216051036519933619121211",
"33524209794551344939606314322012955405475763650427601375548188266683418281737",
"109719024133739006071887734421503574385240299438637848221312871279531507335373",
"94295634091910751384219255754307366832386817535148692594178452899981904510349",
"23540807602748897502784056840352469440092267688926655268523942383033239271514",
"43195615523198986646137461325416770369644487634343780437558068701962592098393",
"21300498159567054510664076375832090581182641724160366759295212971743102472802",
"73129833246344659436170239559200902232733072293144565610201294116422813449858",
"83757132520223907956128845121846546520691785889130995485424503210740636787928",
"38034069171402128677508051459465652412232125765979551871550118653309832377339",
"95264341711326313334608805134035199979975208194386462544729644391978058016716",
"71690611021044114254390209200310048776787626085238485495770045596734825210135",
"20865792730631321384649314082369450337696301957031921138259468828275321371583",
"65545243006239656065148544930270543934832508063657488632367175882958330423520",
"67286631240095429517332425848965263469915248608949489919222072009462008205222",
"90194994262636298290619801523644724885886706816862293971973337750020183308104",
"81410689758564262621649871446987252302802100569118594768300072005283382301345",
"27045209406969154141516065478004441277528090445887994258910081588122962136477",
"58017162768501054013958399326102725906846766093793792708581451795659876075061",
"63607193922483148716287364749906908451410010231454078134893963880393811378570",
"15077581398843846035858829061410519863992196017303268493987148506638894649252",
"98720543333008365957428842648395499537619998158407628689830574814524916841286",
"82097551116909484901235421669485737701367854944566981962862539971389204000912",
"65696974854303663111346694580199887948166117804727316884535568641342825236141",
"82022072372589756245038362844999545949991833918503801914572546267828539432312",
"41743104142431379145575879684871369191818773257805223585003319737262765892166",
"89152726734817076655885191579239291105920640800467128612165758805100847396895",
"85096787237362219033233897011712167073212532843081643096342197033384628131655",
"36584319326860554514086079653749599545350768547152960579674155835632057540199",
"77062317593758970995349360186046782499046125989850129014181198937324174731233",
"32434674498988201382880714205444833644297113250503858134962698908301362589042",
"72391350051359185312356865704781680380033308946588594576490600457222691619987",
"27401111779274505859474277526034309524183210054439621558252535437176398360866",
"26440342071953645885111643680188073141270545427288269626288684084542710779498",
"74671092131207457141148914541116029556928726626873085803387405550383199736991",
"105420983691402167317344111807366460698363469574107073321029898771857907851197",
"50423203290323757979827034025881325367279850708910155043657171341456316335813",
"76273094246579167578947623441053151470442842652633110952136608490863686772230",
"77349351205821667355576798866726899005297081232496131658155334167091501835259",
"62820710895007059009948073591010328268059993819869726382508957546327501676145",
"84219298513439102084011100265432378974884968858951166260976872237576771675611",
"7062312018330804227149826539528347239967296658009541302172574778709468701567",
"54598050755682590662896881851603252710083503137157066570946537660780013477312",
"78031826371626837175741961921006370515732708870306598104042499422384672039609",
"94573195647526804446891441092411100568192275941639229102824324106630433330812",
"60612661404819903021646006418159933313406101990943244358393743988904954999712",
"75097356451484606426541693530224959273765265324112190370696394103450364430966",
"76553167451409852064578676586684434829635588572230706766734645171949446607832",
"113252722515369380396316486466861927844680087774196925377364953525608223442544",
"58164809224635715593100755756239343997397413915961003634461779076482575181963",
"37220070791342015701427580324830917729104228909239839216901635895034019813787",
"23084583598172054535556855062369289127322171411788341968795923964559411646710",
"76332236492061357852602448130460846762160746231228488303286547605701602165352",
"104869025219393122350661024060605601793492588286447466357724614600912755436304",
"112071817242374149431866405393160731064756217452225880381832755683479405855495",
"15053965036032391428041688940389113763547460245652317576208859578681168643875",
"1338786158790165548241429236229868860750647210784180820183518941206889563450",
"90223970560607854094453183849956864804071122464206503343968665898681282953180",
"1158956904092399062387187452152996941085279016741617975512770972585326068522",
"65886185603712211765057365311829183366007789868864785541428974354800907265812",
"86605874029592731046834770532898245353662706290409781435634809509617763681032",
"41441575629653807894802063362449695291008767506764223672145720843058841939814",
"24711740606157353101930369589612449092324637368543384762661485834128546761377",
"97187357119203842577394646329420168771076214118056408333405574785032260268161",
"35785378872550801565360405364920024074458547526395257114155422006864906765548",
"81388649410841082913378785149748420988140074317433647490899449933001550620103",
"99222578339787966070515919096365731775326820597751457228012182448034791589993",
"110723712972010590663394360115187513040051937236404418282576180044231342448145",
"8240129747201327390942134253285184535526753140927948069770529002427229145382",
"28145265528269837372210033703006253093900979452541186405937580769506602407079",
"100947330462526311234268675432613625009268814864324159550099856277009840990302",
"80143318264595830199184975642081918192763369177460243303063210593997806766519",
"62433104700619514135880553644766059219069064189903192572130585356604459359688",
"86735242583287725529691586839870381919754688455468058174983857477322055561066",
"24335980667636667339140969202303746115171543201377469946838559372833175021234",
"114010491183496986124101284983605685034265311563075765667243132985512725444490",
"7573732524435020011715654101485596307284307416556821882741468719297048917534",
"32021170662296861463637055159792965707303276226534757275734557744469741643293",
"109435360975235444272518880413091176824206684942264407969551081285250102813866",
"86681401814812762592536130441945128320424801221049134624632523283452734926271",
"86399041733417222818886796186409476423507588757705555496956347781296956551822",
"108335769632705313952474389063743852041718173826143709699129476683378175402459",
"86223830626057148597507114068300427750595871529261956463485707290864481501507",
"54015725380723240678571565134148179944164074424729315033029681085269054336798",
"98528404517698810972409140924983803215043964822501148750127411772982840221370",
"78413024364342176199455406285816171564007166467083475724035165663519689634674",
"12250250056780845924368136649190675081227619750113031166608312824316214575576",
"28286558784767284983535528093227174475551114392146628252802754325387301093286",
"30450998196790501548444536617455218327786170748802510817098621767807634793133",
"63112202715130794909613090864033397718469253949416872273249618281827072523912",
"79448985751126274199614746561510560352840231437863303349353619470428810680423",
"91891196484330118575911373908903193597528801350759624229542693353138790085449",
"68994191514942535917809858532686811021936031787264188134924270089663654902691",
"20088193977721247987824368928057624084852500927417362895761205225074346285513",
"63703936825248887112984007368773937895763663908179784905699458021637635736358",
"50144268559302450767991880246416728174217532139148056770535353775908451872390",
"63108945250236096216694849137500107978527975821279597028621166129241438006122",
"57035546575970486316767868351180001789693656623032586166349632329342306113670",
"23732029300848190575282030204103238155646585720917053427386137603515274873458",
"46539474391521160158516894125446392808719194944759703330263870711966664621156",
"67720578016383057214494573257898179234656770799118748885849901589197048931912",
"4876905511088212487608854247380930079027080267335729766085671974029925734987",
"68489249575779794675814056905510424597574133077652710561952851629351839482272",
"97599078055694156832316708148689955860796249262681691619225596345632378923779",
"49690623636381849250102136197680113294231921675216038480077933917290527284728",
"6098250716354252474983545997959642789006856188808290029611904968825124059657",
"68587733544204353006098941839810519987277119221727002941833030918564858301739",
"38006171181711062708005149746726781615688737534335051667087569243108502314766",
"101184702354589262049327522037950023205402196410408427144389286011976615756287",
"73624143914187416506180443539612410064035600521911106284226444407071088175782",
"65993490324989506044564529926483478548503891220564266121790027634538016620574",
"93897119739697010428351893815231441884729986356061131708040333640620225323274",
"104571995680167160740050226009818325914636499542112740277555313018593671259991",
"10372358363642279139209386261208677352991753391474931191018976759652439413842",
"63166873948364570605659652402883699112587472784388110603838351829798311951369",
"113094552917366648155009237461374743091517754810067089063405743230918080339908",
"57740575467582006455438330485595299269093011039973229751136437235881086949052",
"2418734261415338037921169003120841533186187949714562467947905339219977677243",
"87571253607041227566932594995484841775137355517033095610781082046799239906590",
"13465731678858011574988739748858259190014867173582746754027108457002607429870",
"10441364766819160444702763956582649724808202827990520264523810544356710387175",
"22864866721876741465476154177557333514517548863605129713517415723998557757660",
"52799567142509786818673193781221783829385393816999113823733873068440571729287",
"109851299716673983059832448397565366242059637346794344516019083699986240233533",
"46491822710592758006999867953245890881403915676670511989817452146152273697093",
"75022713443819749153472121358214109908919011396136286827404487835266377397692",
"13595070676962937959085732916734968350153036660153173093408460306457567115046",
"9544372584010269777760874417891562026854203095759382257081998805036488261357",
"73427150759619024367320957336691564349910204935134080797269963633162575141484",
"2934609625600129817900666324266361087398715425334092772434505450632330186198",
"45821597976539454726699810055516288446057445038237181499253010755153164674695",
"62857475219445315297789349393307186748244087974121212711836768519590567128001",
"26370890049338951865272207335964929387284840252905376761429872986856975068271",
"27985371524789226100974116026031118907552065507385680219273552480908759032271",
"52510765136052836964377686417181800207653399431993808363304193650423160678888",
"67684827399205728637865402621766350106608519173743239162132808561823276756011",
"20041652799469233582631863260753559080166501956015461487208950724944345311507",
"57451399417641204976393178767237639124565955336140472066667650461137234062155",
"7204331052357969508815892185920879274283277092039139095112518950725747772565",
"8908908816278445788171441657117440324110787169696683120059537702412334838947",
"63093746179781870233943155473368473772659565642692388763460952353461378896143",
"115148596234487183965028317492150240472924923905933763345539539105683949684755",
"82689695963181614964672469444628040265073047194309947705752074689533597873973",
"59040873810476083072611565607932841844853969962676221130078625934854425681630",
"40352263827212544949380146299829653359229662496838441109581651057464527356488",
"50403880516215676772109492703779475401298211138392746934735300247635734450513",
"79999935095673051901992909529741587537262503644819439397621285182221753469343",
"69614250154647327703338668174917809231553558651599888312811261115535537955834",
"64410182590619269299557987410304229301968570920784931744941945313114176744103",
"85233864840575045332479379579475977538246707561241783267081869259502599950488",
"52045001331895400481311640607414308302466746183258122498586688852510248236775",
"79677612226873909610081217802307527236651011826119229039973799353141298472061",
"66327680564377905733221671081610361925301158417018591910188503648807044894112",
"83446592362711939986912771129838720065143947490767049177974883820312706925918",
"14911477640029496196154552596875990931097387934989624182067609222165255825505",
"13018025723892024211479002619041013254056785290075007095692190643722202484802",
"90923395081443447345901210299296237358109493459210723906212626955555769266784",
"8735527377739351927737310013435437792123284368378008059197544078887480523426",
"58239109972153801801966669291574028369032949918318648702689269087300968144981",
"99586568040463902069498287600772032331458256816403475514646417169020849681275",
"50308170305644209207272407836541276817596510435250332262464845465927327010338",
"84979384612847494886208962592803229070464576435770687501324615705098954996855",
"71548323136295278136281079599144978942887415258536812883637440313234815018618",
"30493886829612408453085281596779705281767531563231339036675188790872165440576",
"20336051038261550402390807788502728593795753770364550320872673090574614296784",
"59573954837910088500583736903010785777212254048384765750043910245816547212669",
"114061736963094245491885146168631594165639215193456212173178238901600990710616",
"67967136034391054458921131582488262855813356684352464997938088887973542583028",
"96331220110343719066635120503171997666921090868352274336641598166142223786667",
"20937323129141061094583387292769215047157468028920808758247596511122445909334",
"48148192624246222612473382107094324580469432175595285034662614526637239983418",
"56230785798791663416100977374259726086999544777612301198494190241846771809491",
"109558059369392775481544210478548357881919056761395819630605863994121804691465",
"75756296451129074396856070361702788744483985362468055748193145527360874836498",
"84674740501545135097708919706835522631488727672829467050033660856235835478360",
"78001824320559639392782474596416116398819688869801523049392423073503575217409",
"81119927668474718989300758573857816799483244205074062580017073394152598413529",
"67557143104529640326424671867535561543892946340903052023558097830976015733822",
"42765383169220161923108845612334228571985406375093325127549494690581653268640",
"109217044243226251744317124283040164548863810964516159961687457925476346898664",
"25890398641771890708523753218263375058907518300175893930857480256607482443556",
"74831932555983309493245097349473775531728688994130696599390648746789773266264",
"84136572170990202685083369619195470704243235632964502709011205775631559022978",
"7898912004726199243495720454838056722588453668945827819133309613658324299019",
"31500907421764225524371736306889655497548966250160609841109144104529855945467",
"39322535543924066150416238148340284490953311434081284113231002764875800301418",
"42984872718718576787349537084764667513565449230721249216406746445997251928215",
"81357605171125680892437237102762143392773052743351603516901871505320558977587",
"1871254273185126517364797429529143268080862511055224670487596642591397160410",
"53688269124464989653758338507979530817596300742687407167067443771100110921958",
"56032012835667423951656213209106209705346570074136182580397646287329911387112",
"60142912825544417238174770145092254789557560967496094860940449070968872506967",
"95050424052895770086430739170474284673397500315678364419062519013686729798747",
"37652236173227626479892638954391672343424250288829971429313940236669566812688",
"52522534495403298804490067906428737007879462242566988960308379506033616596134",
"109550736570534377505499851959744254664779061283952875302232681009019973931254",
"70694113093604597919216464654270289814231849283652768578921175891421279056162",
"15890728495520768914998100785621147606582523238187360386493757594879239916517",
"64224208120706467414797621452684578814833260594879567781181783017979723483466",
"70970984675343043313702840836072348017089397718741041892027117710833664218069",
"56023864870440689937531961622040463885908156942617422300704805816343766848691",
"95301573362097544081747682411111375850812050776941388737584239161946648681797",
"85123672134321816458425831865316335048085490930323381775823185760850554765297",
"2105838940432100083478576813550295632986727082903528122019207259249832669656",
"20970164123670044950448409431527709635588866124535878390404913030044459478626",
"19694958197545023846486520895710249399451648092761883182043762022375327588397",
"55135470048903516360894656255450738343438363360418288554852629996369915397387",
"114214454644474957353829688637162080004783610062723599785273926703236621757138",
"77492347932566598395928495803964127440685060125312420944417324724785783244515",
"110800599848734417921767464071369141277810949443470108865779479067631337222039",
"55520950327467800823330089161056065098966936107523139498333789958300379482189",
"27207732124946068031798818217740720432680627152624468676181701768086141579193",
"69666860675639482375768093816778899055860455955131270895371406913482680798220",
"77493740523991463647191780073974186625916862686251219714835954385536192980970",
"74771291239611781952309433955014169321308079886847093521653515961659141846349",
"46222692153669347481887464123704183159984545991177959602299622652852536301565",
"11148761440831180492530561704309380048129610650192583139013255473536737661503",
"39674589029329710074894733204203385268021012229161987251911086410216604259867",
"64138315242027843805773264320842677170572061696514162274523744388737291858770",
"66751934930027665368736253281792705719991153818937267901758862459493466482962",
"106962603031375213756904597377092324637897170511295935272363892945530952329635",
"76974237711592260969021506876811942334513646166665752448432754051665642153618",
"110386437469285080672134778169194418428732833461173771937877146825002095042616",
"5528006150717219907187213526712197104722407250129791865803468592968346090806",
"52782643093874808042353138230540311611289040628544046123591717959081278326418",
"58516920170883364051177839200972322904614268457085766935696812684682937638934",
"34903150535579516944408642969393358898233907149423176755384736522963571947712",
"101663644132291628948941640236167350755556186103463576352391468661100238054595",



            ]
        }
    }

    ws.on("error", function (err: Error) {
        console.log("error SOCKET", "error", err);
        process.exit(1);
    });
    ws.on("close", function (code: number, reason: Buffer) {
        console.log("disconnected SOCKET", "code", code, "reason", reason.toString());
        process.exit(1);
    });

    ws.on("open", function (ev: any) {
        console.log("WebSocket connection established.");

        if (type !== "live-activity") {
            ws.send(JSON.stringify(subscriptionMessage), (err?: Error) => {
                if (err) {
                    console.log("send error", err);
                    process.exit(1);
                }
            }); // send sub message
        }

        setInterval(() => {
            console.log("PINGING");
            ws.send("PING");
        }, 50000);

        if (ev) {
            console.log("open", ev);
        }
    });

    ws.onmessage = function (msg: any) {
        console.log(msg.data);
    };
}

(async () => {
    const creds = await generateApiCreds();
    console.log("got API keys");
    main("market", creds);
})();

